<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generalized Linear Regression â€¢ tidypredict</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="../tidyverse.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../tidyverse-2.css" rel="stylesheet">
<!--optional theme--><link href="../.css" rel="stylesheet">
<meta property="og:title" content="Generalized Linear Regression">
<meta property="og:description" content="tidypredict">
<meta property="og:image" content="https://tidypredict.tidymodels.org/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">tidypredict</a>
        <div class="info hidden-xs hidden-sm">
          <span class="partof">part of <a href="https://tidymodels.org">tidymodels</a></span>
          <span class="version version-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.6</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Model list
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lm.html">Linear Regression - lm()</a>
    </li>
    <li>
      <a href="../articles/glm.html">Generalized Regression - glm()</a>
    </li>
    <li>
      <a href="../articles/ranger.html">Random Forest - Ranger - ranger()</a>
    </li>
    <li>
      <a href="../articles/rf.html">Random Forest - randomForest()</a>
    </li>
    <li>
      <a href="../articles/mars.html">MARS - earth()</a>
    </li>
    <li>
      <a href="../articles/cubist.html">Cubist - cubist()</a>
    </li>
    <li>
      <a href="../articles/xgboost.html">XGboost - xgb.Booster.complete()</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/save.html">Save/Reload</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/non-r.html">Non-R models</a>
    </li>
    <li>
      <a href="../articles/regression.html">Regression spec</a>
    </li>
    <li>
      <a href="../articles/tree.html">Tree model spec</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/sql.html">DB Writeback</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
        <li>
  <a href="https://github.com/tidymodels/tidypredict/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="glm_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Generalized Linear Regression</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidymodels/tidypredict/blob/master/vignettes/glm.Rmd"><code>vignettes/glm.Rmd</code></a></small>
      <div class="hidden name"><code>glm.Rmd</code></div>

    </div>

    
    
<div id="highlights-limitations" class="section level2">
<h2 class="hasAnchor">
<a href="#highlights-limitations" class="anchor"></a>Highlights &amp; Limitations</h2>
<ul>
<li>Defaults to 0-to-1 predictions for <code>binomial</code> family models. That is akin to running <code><a href="https://rdrr.io/r/stats/predict.html">predict(model, type = "response")</a></code>
</li>
<li>Only <em>treatment</em> contrast (<code>contr.treatment</code>) are supported.</li>
<li>
<code>offset</code> is supported</li>
<li>Categorical variables are supported</li>
<li>In-line functions in the formulas are <strong>not supported</strong>:
<ul>
<li>OK - <code>wt ~ mpg + am</code>
</li>
<li>OK - <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate(mtcars, newam = paste0(am))</a></code> and then <code>wt ~ mpg + newam</code>
</li>
<li>Not OK - <code>wt ~ mpg + as.factor(am)</code>
</li>
<li>Not OK - <code>wt ~ mpg + as.character(am)</code>
</li>
</ul>
</li>
<li>Interval functions are not supported: <code><a href="../reference/tidypredict_interval.html">tidypredict_interval()</a></code> &amp; <code><a href="../reference/tidypredict_sql_interval.html">tidypredict_sql_interval()</a></code>
</li>
</ul>
</div>
<div id="how-it-works" class="section level2">
<h2 class="hasAnchor">
<a href="#how-it-works" class="anchor"></a>How it works</h2>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidypredict</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)

<span class="no">df</span> <span class="kw">&lt;-</span> <span class="no">mtcars</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">char_cyl</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"cyl"</span>, <span class="no">cyl</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">wt</span>, <span class="no">char_cyl</span>, <span class="no">am</span>)

<span class="no">model</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span>(<span class="no">am</span> ~ <span class="no">wt</span> + <span class="no">char_cyl</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">df</span>, <span class="kw">family</span> <span class="kw">=</span> <span class="st">"binomial"</span>)</pre></body></html></div>
<p>It returns a SQL query that contains the coefficients (<code>model$coefficients</code>) operated against the correct variable or categorical variable value. In most cases the resulting SQL is one short <code>CASE WHEN</code> statement per coefficient. It appends the <code>offset</code> field or value, if one is provided.</p>
<p>For <code>binomial</code> models, the <a href="https://en.wikipedia.org/wiki/Sigmoid_function">sigmoid</a> equation is applied. This means that the target SQL database type will need to support the exponent function.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidypredict</span>)
<span class="fu"><a href="../reference/tidypredict_sql.html">tidypredict_sql</a></span>(<span class="no">model</span>, <span class="kw pkg">dbplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dbplyr.tidyverse.org/reference/simulate_dbi.html">simulate_mssql</a></span>())
<span class="co">#&gt; &lt;SQL&gt; 1.0 - 1.0 / (1.0 + EXP(20.8527831345691 + (`wt` * -7.85934263583835) + (CASE WHEN (`char_cyl` = 'cyl6') THEN (1.0) WHEN NOT(`char_cyl` = 'cyl6') THEN (0.0) END * 3.10462643177453) + (CASE WHEN (`char_cyl` = 'cyl8') THEN (1.0) WHEN NOT(`char_cyl` = 'cyl8') THEN (0.0) END * 5.37942092366097)))</span></pre></body></html></div>
<p>Alternatively, use <code><a href="../reference/tidypredict_to_column.html">tidypredict_to_column()</a></code> if the results are the be used or previewed in <code>dplyr</code>.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/tidypredict_to_column.html">tidypredict_to_column</a></span>(<span class="no">model</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="fl">10</span>)
<span class="co">#&gt;       wt char_cyl am        fit</span>
<span class="co">#&gt; 1  2.620     cyl6  1 0.96662269</span>
<span class="co">#&gt; 2  2.875     cyl6  1 0.79605201</span>
<span class="co">#&gt; 3  2.320     cyl4  1 0.93208127</span>
<span class="co">#&gt; 4  3.215     cyl6  0 0.21242376</span>
<span class="co">#&gt; 5  3.440     cyl8  0 0.30918450</span>
<span class="co">#&gt; 6  3.460     cyl6  0 0.03783629</span>
<span class="co">#&gt; 7  3.570     cyl8  0 0.13875740</span>
<span class="co">#&gt; 8  3.190     cyl4  0 0.01450687</span>
<span class="co">#&gt; 9  3.150     cyl4  0 0.01975984</span>
<span class="co">#&gt; 10 3.440     cyl6  0 0.04399324</span></pre></body></html></div>
</div>
<div id="under-the-hood" class="section level2">
<h2 class="hasAnchor">
<a href="#under-the-hood" class="anchor"></a>Under the hood</h2>
<p>The parser reads several parts of the <code>glm</code> object to tabulate all of the needed variables. One entry per coefficient is added to the final table. Other variables are added at the end. Some variables are not required for every parsed model. For example, <code>offset</code> is listed because itâ€™s part of the formula (call) of the model, if there were no offset in a given model, that line would not exist.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">pm</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/parse_model.html">parse_model</a></span>(<span class="no">model</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">pm</span>, <span class="fl">2</span>)
<span class="co">#&gt; List of 2</span>
<span class="co">#&gt;  $ general:List of 7</span>
<span class="co">#&gt;   ..$ model   : chr "glm"</span>
<span class="co">#&gt;   ..$ version : num 2</span>
<span class="co">#&gt;   ..$ type    : chr "regression"</span>
<span class="co">#&gt;   ..$ residual: int 28</span>
<span class="co">#&gt;   ..$ family  : chr "binomial"</span>
<span class="co">#&gt;   ..$ link    : chr "logit"</span>
<span class="co">#&gt;   ..$ is_glm  : num 1</span>
<span class="co">#&gt;  $ terms  :List of 4</span>
<span class="co">#&gt;   ..$ :List of 5</span>
<span class="co">#&gt;   ..$ :List of 5</span>
<span class="co">#&gt;   ..$ :List of 5</span>
<span class="co">#&gt;   ..$ :List of 5</span>
<span class="co">#&gt;  - attr(*, "class")= chr [1:3] "parsed_model" "pm_regression" "list"</span></pre></body></html></div>
<p>The output from <code><a href="../reference/parse_model.html">parse_model()</a></code> is transformed into a <code>dplyr</code>, a.k.a Tidy Eval, formula. All categorical variables are operated using <code><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else()</a></code>.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="../reference/tidypredict_fit.html">tidypredict_fit</a></span>(<span class="no">model</span>)
<span class="co">#&gt; 1 - 1/(1 + exp(20.8527831345691 + (wt * -7.85934263583835) + </span>
<span class="co">#&gt;     (ifelse(char_cyl == "cyl6", 1, 0) * 3.10462643177453) + (ifelse(char_cyl == </span>
<span class="co">#&gt;     "cyl8", 1, 0) * 5.37942092366097)))</span></pre></body></html></div>
<p>From there, the Tidy Eval formula can be used anywhere where it can be operated. <code>tidypredict</code> provides three paths:</p>
<ul>
<li>Use directly inside <code>dplyr</code>, <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate(df, !! tidypredict_fit(model))</a></code>
</li>
<li>Use <code><a href="../reference/tidypredict_to_column.html">tidypredict_to_column(model)</a></code> to a piped command set</li>
<li>Use <code>tidypredict_to_sql(model)</code> to retrieve the SQL statement</li>
</ul>
<p>The same applies to the prediction interval functions.</p>
</div>
<div id="how-it-performs" class="section level2">
<h2 class="hasAnchor">
<a href="#how-it-performs" class="anchor"></a>How it performs</h2>
<p>Testing the <code>tidypredict</code> results is easy. The <code><a href="../reference/tidypredict_test.html">tidypredict_test()</a></code> function automatically uses the <code>lm</code> model objectâ€™s data frame, to compare <code><a href="../reference/tidypredict_fit.html">tidypredict_fit()</a></code>, and <code><a href="../reference/tidypredict_interval.html">tidypredict_interval()</a></code> to the results given by <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code></p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="../reference/tidypredict_test.html">tidypredict_test</a></span>(<span class="no">model</span>)
<span class="co">#&gt; tidypredict test results</span>
<span class="co">#&gt; Difference threshold: 1e-12</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  All results are within the difference threshold</span></pre></body></html></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="tidyverse">
  <p>tidypredict is a part of the <strong>tidymodels</strong> ecosystem, a collection of modeling packages designed with common APIs and a shared philosophy.</p>
</div>

<div class="author">
  <p>
    Developed by Max Kuhn.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>

      </footer>
</div>

  


  </body>
</html>
